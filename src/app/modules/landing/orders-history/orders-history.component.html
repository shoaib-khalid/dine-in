<!-- Order List -->
<div class="relative flex flex-col items-center bg-card w-full h-full">
    <!-- Main menu -->
    <div class="flex flex-col items-center w-full h-auto">
        <!-- Container -->
        <div class="flex flex-col justify-center mt-4 w-full">
            <!-- Order Details -->
            <div class="flex flex-col w-full">
                <!-- Orders -->
                <ng-container *ngIf="openTab !== 'ALL'; else orderGroups">
                    <ng-container *ngIf="(ordersDetails$ | async) as ordersDetails; else noOrder">
                        <ng-container *ngIf="ordersDetails.length > 0">
                            <ng-container *ngFor="let orderDetails of ordersDetails; let i = index">
                                <!-- Orders -->
                                <div class="flex flex-col md:flex-row w-full justify-between bg-card border border-gray-300 rounded-lg p-2 mb-1 sm:mb-2">
                                    <div class="flex flex-col w-full">
                                        <!-- Header -->
                                        <div class="flex flex-row my-1 items-start justify-between w-full sm:px-2">
                                            <!-- Store Details -->
                                            <div class="flex flex-row">
                                                <mat-icon class="text-primary" svgIcon="mat_solid:storefront"></mat-icon>
                                                <div class="flex flex-col px-2">
                                                    <h3 class="font-bold cursor-pointer line-clamp-1" (click)="redirectToStore(orderDetails.store.domain)">{{orderDetails.store.name}}</h3>
                                                    <h3 class="text-gray-400 text-xs">Order ID : {{orderDetails.invoiceId}}</h3>
                                                    <h3 class="text-gray-400 text-xs">Order Placed : {{ convertDate(orderDetails.orderTimeConverted) | date:'MMM dd, h:mm a' }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Border -->
                                        <div class="border-t w-full"></div>
                                        <!-- Body -->
                                        <div class="flex flex-col items-center w-full">
                                            <ng-container *ngFor="let orderItemDetail of orderDetails.orderItemWithDetails; let j = index">
                                                <ng-container *ngIf="displayAll[i].orderItemsId[j].isDisplay">
                                                    <div (click)="redirectToProduct(orderDetails.store.id, orderDetails.store.domain, orderItemDetail.product.seoNameMarketplace)"  
                                                        class="flex flex-row items-center justify-around w-full py-2 cursor-pointer group hover:bg-primary-50 sm:px-2 gap-1 sm:gap-2">
                                                        <div class="w-13 h-13 relative flex flex-0 items-center justify-center mr-2 rounded overflow-hidden border">
                                                            <img
                                                                class="w-full"
                                                                [alt]="'Product thumbnail image of ' + orderItemDetail.productName"
                                                                [src]=
                                                                    "orderItemDetail.itemAssetDetails ? orderItemDetail.itemAssetDetails.url 
                                                                    : orderItemDetail.product.thumbnailUrl ? orderItemDetail.product.thumbnailUrl 
                                                                    : orderDetails.store.storeLogoUrl ? orderDetails.store.storeLogoUrl
                                                                    : platform.logoSquare">
                                                        </div>
                                                        <div class="w-full flex flex-col">
                                                            <h3 
                                                                class="font-semibold text-sm group-hover:text-primary line-clamp-3">
                                                                {{orderItemDetail.productName}}
                                                            </h3>
                                                            <div class="">
                                                                <!-- Display variants -->
                                                                <h3 class="font-medium text-xs sm:text-base text-gray-400">{{orderItemDetail.productVariant}}</h3>
                                                                <!-- <ng-container *ngIf="orderItem.productInventory.productInventoryItems.length > 0">
                                                                    <div class="flex flex-wrap items-center gap-1">
                                                                        <ng-container *ngFor="let variant of cartItem.productInventory.productInventoryItems; let isLast=last">
                                                                            <span class="truncate tracking-tight max-w-32 leading-tight text-xs lg:text-sm text-secondary">{{variant.productVariantAvailable.productVariant.name}}: {{variant.productVariantAvailable.value}}{{isLast ? '' : ', '}}</span>
                                                                        </ng-container>
                                                                    </div>
                                                                </ng-container> -->
                                                                <!-- Display Combo -->
                                                                <ng-container *ngIf="orderItemDetail.orderSubItem.length > 0">
                                                                    <div class="flex flex-wrap items-center gap-x-1">
                                                                        <ng-container *ngFor="let combo of orderItemDetail.orderSubItem; let isLast=last">
                                                                            <span class="truncate tracking-tight max-w-32 leading-tight text-xs lg:text-sm text-secondary">{{combo.productName}}{{isLast ? '' : ', '}}</span>
                                                                            <!-- <span class="block last:hidden leading-tight text-xs lg:text-sm text-secondary">,&nbsp;</span> -->
                                                                        </ng-container>
                                                                    </div>
                                                                </ng-container>
                                                            </div>
                                                        </div>
                                                        <div class="w-1/2 md:w-2/3 flex flex-row justify-between items-center leading-tight">
                                                            <span class="text-gray-400 items-center text-sm group-hover:text-primary">x{{orderItemDetail.quantity}}</span>
                                                            <div class="flex flex-col md:flex-row justify-between w-3/5 items-end leading-none">
                                                                <span *ngIf="orderItemDetail.normalPrice && orderItemDetail.normalPrice !== orderItemDetail.price && orderItemDetail.orderItemAddOn.length === 0"
                                                                    class="text-gray-400 items-start text-left text-xs line-through">{{orderItemDetail.normalPrice * orderItemDetail.quantity | currency: orderDetails.store.regionCountry.currencySymbol}}</span>
                                                                <span class="font-semibold text-primary text-sm">{{orderItemDetail.price | currency: orderDetails.store.regionCountry.currencySymbol}}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </ng-container>
                                            <ng-container *ngIf="displayAll[i].isDisplayAll === true">
                                                <div class="border-b w-full py-1"></div>
                                                <span class="text-primary pt-2 pb-2 sm:pb-0 cursor-pointer" (click)="showAllOrderItems(orderDetails.id)">See More</span>
                                            </ng-container>
                                        </div>
                                    </div>
                                    <!-- Footer -->
                                    <div class="flex flex-col w-full md:w-120 md:ml-4 border-t md:border-t-0 pt-1 md:pt-0">
                                        <div class="flex flex-col md:border rounded-lg py-1 px-0.5 md:px-2 md:py-2 md:h-full">
                                            <!-- Order Summary -->
                                            <div class="flex flex-col w-full mb-2 leading-none gap-2">
                                                <!-- Title -->
                                                <div class="hidden md:flex flex-row items-center border-b mb-1 pb-1">
                                                    <mat-icon class="text-primary" [svgIcon]="'mat_outline:receipt_long'"></mat-icon>
                                                    <span class="ml-2 font-bold">Order Summary</span>
                                                </div>
                                                <!-- Sub Total -->
                                                <!-- <div class="flex flex-row w-full justify-between items-start">
                                                    <div class="flex flex-row items-end">
                                                        <span class="text-left font-semibold text-gray-500 text-sm">Sub Total&nbsp;</span> 
                                                        <span class="text-left text-gray-500 text-xs">({{numberOfItems(orderDetails.orderItemWithDetails)}})</span>
                                                    </div>
                                                    <div class="flex justify-between w-20">
                                                        <span class="font-semibold text-gray-500 text-sm">:</span>
                                                        <span class="text-right font-semibold text-gray-500 text-sm">{{ orderDetails.subTotal | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                    </div>
                                                </div> -->
                                                <!-- Order Discount -->
                                                <ng-container *ngIf="orderDetails.appliedDiscount !== 0">
                                                    <div class="flex flex-row w-full justify-between items-start">
                                                        <div class="flex flex-col leading-tight">
                                                            <div class="flex flex-row items-end">
                                                                <span class="text-left font-medium text-gray-500 text-sm">Order Discount</span> 
                                                                <!-- <span class="text-left text-gray-500 font-normal text-xs" *ngIf="orderDetails.appliedDiscountDescription">&nbsp;({{orderDetails.appliedDiscountDescription}})</span> -->
                                                            </div>
                                                            <span *ngIf="orderDetails.discountMaxAmount && orderDetails.discountMaxAmount != 0 && orderDetails.appliedDiscount >= orderDetails.discountMaxAmount && orderDetails.appliedDiscount != 0" 
                                                                class="text-xs text-gray-400 mt-1">Capped at {{orderDetails.discountMaxAmount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                        <div class="flex justify-between w-20">
                                                            <!-- <span class="items-center font-medium text-gray-500 text-sm">:</span> -->
                                                            <span class="text-right font-medium text-gray-500 text-sm w-20">-{{ orderDetails.appliedDiscount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <!-- Service Charges -->
                                                <ng-container *ngIf="orderDetails.storeServiceCharges !== 0">
                                                    <div class="flex flex-row w-full justify-between items-start">
                                                        <span class="text-left font-medium text-gray-500 text-sm">Service Charge</span>
                                                        <div class="flex justify-between w-20">
                                                            <span class="items-center font-medium text-gray-500 text-sm">:</span>
                                                            <span class="text-right font-medium text-gray-500 text-sm w-20">{{ orderDetails.storeServiceCharges | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <!-- Delivery Charges -->
                                                <ng-container *ngIf="orderDetails.deliveryCharges !== 0">
                                                    <div class="flex flex-row w-full justify-between items-start">
                                                        <span class="text-left font-medium text-gray-500 text-sm">Delivery Fee</span>
                                                        <div class="flex justify-between w-20">
                                                            <span class="items-center font-medium text-gray-500 text-sm">:</span>
                                                            <span class="text-right font-medium text-gray-500 text-sm w-20">{{ orderDetails.deliveryCharges | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <!-- Delivery Discount -->
                                                <ng-container *ngIf="orderDetails.deliveryDiscount !== 0">
                                                    <div class="flex flex-row w-full justify-between items-start">
                                                        <div class="flex flex-col leading-tight">
                                                            <div class="flex flex-row items-end">
                                                                <span class="text-left font-medium text-gray-500 text-sm">Delivery Discount</span> 
                                                                <!-- <span class="text-left text-gray-500 font-normal text-xs" *ngIf="orderDetails.deliveryDiscountDescription">&nbsp;({{orderDetails.deliveryDiscountDescription}})</span> -->
                                                            </div>
                                                            <span *ngIf="orderDetails.deliveryDiscountMaxAmount && orderDetails.deliveryDiscountMaxAmount != 0 && orderDetails.deliveryDiscount >= orderDetails.deliveryDiscountMaxAmount && orderDetails.deliveryDiscount != 0" 
                                                                class="text-xs text-gray-400 mt-1">Capped at {{orderDetails.deliveryDiscountMaxAmount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                        <div class="flex justify-between w-20">
                                                            <span class="items-center font-medium text-gray-500 text-sm">:</span>
                                                            <span class="text-right font-medium text-gray-500 text-sm">-{{ orderDetails.deliveryDiscount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <!-- Total Amount -->
                                                <div class="flex flex-row w-full justify-between items-start border-t pt-1.5">
                                                    <span class="text-left font-semibold text-sm">Total Amount</span> 
                                                    <div class="flex justify-between w-20">
                                                        <span class="items-center font-semibold text-sm">:</span>
                                                        <span class="text-right font-semibold text-sm w-20">{{ orderDetails.total | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                    </div>
                                                </div>
                                                <!-- <p class="items-center font-semibold text-gray-400 text-sm">Total Order :</p> 
                                                <h3 class="w-full text-lg font-semibold text-sm">{{orderDetails.total | currency: orderDetails.store.regionCountry.currencySymbol}}</h3> -->
                                            </div>
                                            <!-- Order Details Button -->
                                            <div class="flex flex-row w-full justify-end">
                                                <input
                                                    id="order-list-button"
                                                    type="button"
                                                    class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                                                    mat-button
                                                    >
                                                <label 
                                                    [routerLink]="['/order-history/orders-history-details/  + orderDetails.id']"
                                                    class="flex items-center justify-center h-8 sm:h-10 w-full px-1 sm:px-2 rounded-lg bg-primary hover:bg-primary-600 cursor-pointer"
                                                    for="add-to-cart-button"
                                                    matRipple>
                                                    <span class="text-sm font-semibold text-black tracking-tight">Order Info</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>    
                    </ng-container>
                    <!-- No Products -->
                    <ng-template #noOrder>
                        <div *ngIf="!isLoadingOnInit" class="relative w-full h-100 sm:h-auto max-h-160">
                            <error-background class="w-full static opacity-40"></error-background>
                            <div class="absolute flex flex-col inset-0 justify-center items-center">
                                <div class="w-full flex flex-col items-center justify-center z-10">
                                    <div class="mt-2 text-4xl md:text-5xl font-semibold tracking-tight leading-tight md:leading-none text-center">No Order Found !</div>
                                    <div class="mt-4 max-w-120 text-lg md:text-xl font-medium tracking-tight text-center text-secondary">No order found, shop and place your first order with us.</div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="mb-12"></div> -->
                    </ng-template>
                    <!-- Pagination -->
                    <div class="flex w-full mt-4 items-center justify-center">
                        <pagination 
                            *ngIf="ordersDetailsPagination && ordersDetailsPagination.length > ordersDetailsPagination.size"
                            [itemLength]="ordersDetailsPagination.length" 
                            [initialPage]="ordersDetailsPagination.page + 1"
                            [pageSize]="ordersDetailsPagination.size"
                            (changePage)="onChangePage($event, 'orderDetails')"
                            (click)="scrollToTop()"
                            #ordersDetailsPaginator></pagination>
                    </div>
                </ng-container>
                <ng-template #orderGroups>
                    <ng-container *ngIf="(ordersGroups$ | async) as ordersGroups; else noOrderGroup">
                        <ng-container *ngIf="ordersGroups.length > 0">
                            <ng-container *ngFor="let ordersGroup of ordersGroups; let i = index">
                                <!-- Order Groups -->
                                <div class="flex flex-col w-full bg-primary-100 border border-gray-300 rounded-lg py-1 sm:py-2 px-1 sm:px-2 mb-4">
                                    <!-- Header -->
                                    <div class="flex flex-row mb-1 mt-1 items-start justify-start w-full sm:px-1">
                                        <!-- Store Details -->
                                        <div class="flex flex-row justify-between items-center w-full mx-1">
                                            <div class="flex flex-row items-center">
                                                <!-- <mat-icon class="text-primary" [svgIcon]="'mat_outline:receipt_long'"></mat-icon> -->
                                                <div class="flex flex-col ml-0.5 leading-none gap-1">
                                                    <!-- <span class="text-gray-400 text-xs">Order ID : {{ ordersGroup.id }}</span> -->
                                                    <span class="text-gray-400 text-xs">Total Order Summary : Ordered from {{ ordersGroup.orderList.length }} {{ ordersGroup.orderList.length > 1 ? 'shops' : 'shop' }}</span>
                                                    <span class="text-gray-400 text-xs">Order Placed : {{ convertDate(ordersGroup.orderTimeConverted) | date:'MMM dd, h:mm a' }} </span>
                                                    <div class="flex flex-row text-xs">
                                                        <span class="text-gray-400">Payment Status :&nbsp;</span>
                                                        <span 
                                                        [ngClass]="{
                                                            'text-green-500' : ordersGroup.paymentStatus === 'PAID',
                                                            'text-amber-500' : ordersGroup.paymentStatus === 'PENDING',
                                                            'text-red-500' : ordersGroup.paymentStatus === 'FAILED'
                                                        }">{{ordersGroup.paymentStatus}}</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                class="flex flex-row"
                                                [ngClass]="ordersGroup.orderQrPaymentStatus === 'PENDING' && tagType === 'restaurant' ? 'visible' : 'invisible'"
                                            >
                                                <input
                                                    id="order-more-button"
                                                    type="button"
                                                    class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                                                    mat-button
                                                    >
                                                <label
                                                    (click)="goToHome()"
                                                    class="flex items-center justify-center h-8 w-20 px-1 sm:px-2 rounded-lg bg-primary cursor-pointer"
                                                    for="order-more-button"
                                                    matRipple>
                                                    <span class="text-sm font-light text-white tracking-tighter px-1">Order More</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
            
                                    <ng-container *ngFor="let orderDetails of ordersGroup.orderList; let j = index">
                                        <!-- Orders -->
                                        <div class="flex flex-col md:flex-row w-full justify-between bg-card border border-gray-300 rounded-lg p-2 sm:mb-2"
                                            [ngClass]="ordersGroup.orderList.length > 1 ? 'mb-1' : 'mb-0'">
                                            <div class="flex flex-col w-full">
                                                <!-- Header -->
                                                <div class="flex flex-row mt-1 mb-2 items-start justify-between w-full sm:w-1/2 sm:px-2">
                                                    <!-- Store Details -->
                                                    <div class="flex flex-row w-full items-center">
                                                        <!-- <mat-icon class="text-primary" svgIcon="mat_solid:storefront"></mat-icon> -->
                                                        <img
                                                            class="object-cover w-8 h-8 rounded-full shadow ring-1 ring-white"
                                                            [src]="displayStoreLogo(orderDetails.store.storeAssets)">
                                                        <div class="flex flex-col pl-2 w-full leading-none gap-1">
                                                            <span class="font-semibold cursor-pointer line-clamp-1" (click)="redirectToStore(orderDetails.store.domain)">{{orderDetails.store.name}}</span>
                                                            <span class="text-gray-400 font-normal text-xs">Order ID : {{orderDetails.invoiceId}}</span>
                                                            <!-- <span class="text-gray-400 text-xs">Order Placed : {{ convertDate(orderDetails.orderTimeConverted) | date:'MMM dd, h:mm a' }}</span> -->
                                                            <div class="flex flex-row justify-between">
                                                                <span class="text-blue-700 text-xs font-normal">Notes : {{ orderDetails.customerNotes }}</span>
                                                                <div *ngIf="orderDetails.dineInOption === 'SELFCOLLECT'" class="flex flex-row gap-1 items-center">
                                                                    <span class="text-blue-700 text-xs font-normal">Phone No :</span>
                                                                    <span 
                                                                        (click)="editPhoneNo(ordersGroup.id, orderDetails.id, orderDetails.orderShipmentDetail.phoneNumber)"
                                                                        class="underline text-xs text-blue-700 font-normal tracking-tight cursor-pointer">{{ orderDetails.orderShipmentDetail.phoneNumber }}</span>
                                                                    <mat-icon 
                                                                        (click)="editPhoneNo(ordersGroup.id, orderDetails.id, orderDetails.orderShipmentDetail.phoneNumber)"
                                                                        class="icon-size-3 cursor-pointer text-primary" 
                                                                        [svgIcon]="'heroicons_solid:pencil'"></mat-icon>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Border -->
                                                <div class="border-t w-full"></div>
                                                <!-- Body -->
                                                <div class="flex flex-col w-full items-center">
                                                    <ng-container *ngFor="let orderItemDetail of orderDetails.orderItemWithDetails; let k = index">
                                                        <!-- <span>{{i}} | {{j}} | {{k}} | {{ordersGroupsPagination.page}}</span> -->
                                                        <ng-container *ngIf="displayAllGroup[i].orderList[j] && displayAllGroup[i].orderList[j].orderItemsId[k].isDisplay">
                                                            <div (click)="redirectToProduct(orderDetails.store.id, orderDetails.store.domain, orderItemDetail.product.seoNameMarketplace)"  
                                                                class="flex flex-row items-center justify-around w-full py-2 cursor-pointer group hover:bg-primary-50 sm:px-2 gap-1 sm:gap-2">
                                                                <div class="w-12 h-12 relative flex flex-0 items-center justify-center mr-2 rounded overflow-hidden border">
                                                                    <img
                                                                        class="h-full object-cover"
                                                                        [alt]="'Product thumbnail image of ' + orderItemDetail.productName"
                                                                        [src]=
                                                                            "orderItemDetail.itemAssetDetails ? orderItemDetail.itemAssetDetails.url 
                                                                            : orderItemDetail.product.thumbnailUrl ? orderItemDetail.product.thumbnailUrl 
                                                                            : orderDetails.store.storeLogoUrl ? orderDetails.store.storeLogoUrl
                                                                            : platform.logoSquare">
                                                                </div>
                                                                <div class="w-full flex flex-col pr-1">
                                                                    <h3 
                                                                        class="font-medium text-sm group-hover:text-primary line-clamp-2">
                                                                        {{orderItemDetail.productName}}
                                                                    </h3>
                                                                    <div class="">
                                                                        <!-- Display variants -->
                                                                        <h3 class="tracking-tight leading-tight text-xs lg:text-sm text-secondary">{{orderItemDetail.productVariant}}</h3>
                                                                        <!-- <ng-container *ngIf="orderItem.productInventory.productInventoryItems.length > 0">
                                                                            <div class="flex flex-wrap items-center gap-1">
                                                                                <ng-container *ngFor="let variant of cartItem.productInventory.productInventoryItems; let isLast=last">
                                                                                    <span class="truncate tracking-tight max-w-32 leading-tight text-xs lg:text-sm text-secondary">{{variant.productVariantAvailable.productVariant.name}}: {{variant.productVariantAvailable.value}}{{isLast ? '' : ', '}}</span>
                                                                                </ng-container>
                                                                            </div>
                                                                        </ng-container> -->
                                                                        <!-- Display Combo -->
                                                                        <ng-container *ngIf="orderItemDetail.orderSubItem.length > 0">
                                                                            <div class="flex flex-wrap items-center gap-x-1">
                                                                                <!-- <ng-container *ngFor="let combo of orderItemDetail.orderSubItem; let isLast=last">
                                                                                    <span class="truncate tracking-tight max-w-32 leading-tight text-xs lg:text-sm text-secondary">{{combo.productName}}{{isLast ? '' : ', '}}</span>
                                                                                </ng-container> -->
                                                                                <ng-container *ngFor="let combo of comboSubItemGrouping(orderItemDetail.orderSubItem); let isLast=last">
                                                                                    <span class="tracking-tight leading-tight text-xs lg:text-sm text-secondary">{{combo}}{{isLast ? '' : ', '}}</span>
                                                                                </ng-container>
                                                                            </div>
                                                                        </ng-container>
                                                                        <!-- Display AddOn -->
                                                                        <ng-container *ngIf="orderItemDetail.orderItemAddOn.length > 0">
                                                                            <div class="flex flex-wrap items-center gap-x-1">
                                                                                <ng-container *ngFor="let addon of orderItemDetail.orderItemAddOn; let isLast=last">
                                                                                    <ng-container *ngIf="addon.productAddOn && addon.productAddOn.addOnTemplateItem">
                                                                                        <span class="truncate tracking-tight max-w-32 leading-tight text-xs lg:text-sm text-secondary">{{addon.productAddOn.addOnTemplateItem.name}}{{isLast ? '' : ', '}}</span>
                                                                                    </ng-container>
                                                                                </ng-container>
                                                                            </div>
                                                                        </ng-container>
                                                                    </div>
                                                                </div>
                                                                <div class="w-1/2 md:w-2/3 flex flex-row justify-between items-center leading-tight">
                                                                    <span class="text-gray-500 items-center text-sm group-hover:text-primary">x{{orderItemDetail.quantity}}</span>
                                                                    <div class="flex flex-col justify-between w-3/5 items-end leading-none">
                                                                        <span *ngIf="orderItemDetail.normalPrice && orderItemDetail.normalPrice && orderItemDetail.normalPrice !== orderItemDetail.productPrice && orderItemDetail.orderItemAddOn.length === 0" 
                                                                            class="text-gray-400 items-start text-left text-xs line-through">{{orderItemDetail.normalPrice * orderItemDetail.quantity | currency: orderDetails.store.regionCountry.currencySymbol}}</span>
                                                                        <span class="font-medium text-gray-500 text-sm group-hover:text-primary">{{orderItemDetail.price | currency: orderDetails.store.regionCountry.currencySymbol}}</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                    </ng-container>
                                                    <ng-container *ngIf="displayAllGroup[i].orderList[j] && displayAllGroup[i].orderList[j].isDisplayAll === true">
                                                        <div class="border-b w-full py-1"></div>
                                                        <span class="text-primary text-md sm:text-base pt-2 pb-2 sm:pb-0 cursor-pointer" (click)="showAllGroupOrderItems(ordersGroup.id, orderDetails.id)">See More</span>
                                                    </ng-container>
                                                </div>
                                            </div>
                                            <!-- Footer -->
                                            <div class="flex flex-col w-full md:w-120 md:ml-4 border-t md:border-t-0 pt-1 md:pt-0">
                                                <div class="flex flex-col md:border rounded-lg py-1 px-0.5 md:px-2 md:py-2 md:h-full">
                                                    <!-- Order Summary -->
                                                    <div class="flex flex-col w-full md:mb-1 leading-none gap-2">
                                                        <!-- Title -->
                                                        <div class="hidden md:flex flex-row items-center border-b mb-1 pb-1">
                                                            <mat-icon class="text-primary" [svgIcon]="'mat_outline:receipt_long'"></mat-icon>
                                                            <span class="ml-2 font-bold">Order Summary</span>
                                                        </div>
                                                        <!-- Sub Total -->
                                                        <!-- <div class="flex flex-row w-full justify-between items-start">
                                                            <div>
                                                                <span class="text-left font-medium text-gray-500 text-sm">Sub Total&nbsp;</span> 
                                                                <span class="text-left text-gray-500 text-xs">({{numberOfItems(orderDetails.orderItemWithDetails)}})</span>
                                                            </div>
                                                            <div class="flex justify-end w-20">
                                                                <span class="font-medium text-gray-500 text-sm">:</span>
                                                                <span class="text-right font-medium text-gray-500 text-sm">{{ orderDetails.subTotal | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                            </div>
                                                        </div> -->
                                                        <!-- Order Discount -->
                                                        <ng-container *ngIf="orderDetails.appliedDiscount !== 0">
                                                            <div class="flex flex-row w-full justify-between items-start">
                                                                <div class="flex flex-col">
                                                                    <div class="flex flex-row items-end">
                                                                        <span class="text-left font-medium text-gray-500 text-sm">Order Discount</span> 
                                                                        <!-- <span class="text-left text-gray-500 font-normal text-xs" *ngIf="orderDetails.appliedDiscountDescription">&nbsp;({{orderDetails.appliedDiscountDescription}})</span> -->
                                                                    </div>
                                                                    <span *ngIf="orderDetails.discountMaxAmount && orderDetails.discountMaxAmount != 0 && orderDetails.appliedDiscount >= orderDetails.discountMaxAmount && orderDetails.appliedDiscount != 0" 
                                                                        class="text-xs text-gray-400 mt-1">Capped at {{orderDetails.discountMaxAmount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                                <div class="flex justify-end w-20">
                                                                    <!-- <span class="items-center font-medium text-gray-500 text-sm">:</span> -->
                                                                    <span class="text-right font-medium text-gray-500 text-sm w-20">-{{ orderDetails.appliedDiscount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <!-- Service Charges -->
                                                        <ng-container *ngIf="orderDetails.storeServiceCharges !== 0">
                                                            <div class="flex flex-row w-full justify-between items-start">
                                                                <span class="text-left font-medium text-gray-500 text-sm">Service Charge</span>
                                                                <div class="flex justify-end w-20">
                                                                    <!-- <span class="items-center font-medium text-gray-500 text-sm">:</span> -->
                                                                    <span class="text-right font-medium text-gray-500 text-sm w-20">{{ orderDetails.storeServiceCharges | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <!-- Delivery Charges -->
                                                        <ng-container *ngIf="orderDetails.deliveryCharges !== 0">
                                                            <div class="flex flex-row w-full justify-between items-start">
                                                                <div class="flex flex-row items-end">
                                                                    <span class="text-left font-medium text-gray-500 text-sm">Delivery Fee&nbsp;</span>
                                                                    <span class="text-left text-gray-500 text-xs">{{checkCombineShipping(orderDetails.orderPaymentDetail.deliveryQuotationReferenceId) > 1 ? '(combined x' + checkCombineShipping(orderDetails.orderPaymentDetail.deliveryQuotationReferenceId) + ' shops)' : ''}}</span>
                                                                </div>
                                                                <div class="flex justify-end w-20">
                                                                    <!-- <span class="items-center font-medium text-gray-500 text-sm">:</span> -->
                                                                    <span class="text-right font-medium text-gray-500 text-sm w-20">{{ orderDetails.deliveryCharges | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <!-- Delivery Discount -->
                                                        <ng-container *ngIf="orderDetails.deliveryDiscount !== 0">
                                                            <div class="flex flex-row w-full justify-between items-start">
                                                                <div class="flex flex-col">
                                                                    <div class="flex flex-row items-end">
                                                                        <span class="text-left font-medium text-gray-500 text-sm">Delivery Discount</span> 
                                                                        <!-- <span class="text-left text-gray-500 font-normal text-xs" *ngIf="orderDetails.deliveryDiscountDescription">&nbsp;({{orderDetails.deliveryDiscountDescription}})</span> -->
                                                                    </div>
                                                                    <span *ngIf="orderDetails.deliveryDiscountMaxAmount && orderDetails.deliveryDiscountMaxAmount != 0 && orderDetails.deliveryDiscount >= orderDetails.deliveryDiscountMaxAmount && orderDetails.deliveryDiscount != 0" 
                                                                        class="text-xs text-gray-400 mt-1">Capped at {{orderDetails.deliveryDiscountMaxAmount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                                <div class="flex justify-end w-20">
                                                                    <!-- <span class="items-center font-medium text-gray-500 text-sm">:</span> -->
                                                                    <span class="text-right font-medium text-gray-500 text-sm">-{{ orderDetails.deliveryDiscount | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <!-- Total Amount -->
                                                        <div class="flex flex-row w-full justify-between items-start">
                                                            <span class="text-left font-semibold text-sm">Total Amount</span> 
                                                            <div class="flex justify-end w-20">
                                                                <!-- <span class="items-center font-semibold text-sm">:</span> -->
                                                                <span class="text-right font-semibold text-sm w-20">{{ orderDetails.total | currency: orderDetails.store.regionCountry.currencySymbol }}</span>
                                                            </div>
                                                        </div>
                                                        <!-- <p class="items-center font-semibold text-gray-400 text-sm">Total Order :</p> 
                                                        <h3 class="w-full text-lg font-semibold text-sm">{{orderDetails.total | currency: orderDetails.store.regionCountry.currencySymbol}}</h3> -->
                                                    </div>
                                                    <!-- Order Details Button -->
                                                    <!-- <div class="flex flex-row w-full justify-end">
                                                        <input
                                                            id="order-list-button"
                                                            type="button"
                                                            class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                                                            mat-button
                                                            >
                                                        <label 
                                                            [routerLink]="['/order-history/orders-history-details/'  + orderDetails.id]"
                                                            class="flex items-center justify-center h-8 sm:h-10 w-full px-1 sm:px-2 duration-75 rounded-lg bg-primary hover:bg-primary-600 cursor-pointer"
                                                            for="add-to-cart-button"
                                                            matRipple>
                                                            <span class="text-sm font-semibold text-black tracking-tight">Order Info</span>
                                                        </label>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>

                                    <!-- Footer -->
                                    <div *ngIf="ordersGroup.orderList.length > 1" 
                                        class="flex flex-col sm:items-end w-full px-2 sm:px-4 leading-tight gap-1 my-1 sm:my-0">
                                        <ng-container *ngIf="ordersGroup.platformVoucherDiscount && ordersGroup.platformVoucherDiscount !== 0">
                                            <!-- Total Order Amount -->
                                            <div class="flex flex-row justify-between">
                                                <p class="text-left font-medium text-gray-500 text-sm w-56">Total Order Amount</p> 
                                                <!-- <span class="items-center font-medium text-gray-400 text-sm">:</span> -->
                                                <h3 class="text-right font-medium text-gray-500 text-sm w-20">{{ ordersGroup.totalOrderAmount | currency: platform.currency }}</h3>
                                            </div>
                                            <!-- Platform Voucher Discount -->
                                            <div class="flex flex-row justify-between">
                                                <p class="text-left font-medium text-primary-600 text-sm w-56">Deliverin Voucher Discount</p> 
                                                <!-- <span class="items-center font-medium text-gray-400 text-sm">:</span> -->
                                                <h3 class="text-right font-medium text-primary-600 text-sm w-20">-{{ ordersGroup.platformVoucherDiscount | currency: platform.currency }}</h3>
                                            </div>
                                            <!-- Separator -->
                                            <div class="border-b w-full"></div>
                                        </ng-container>
                                        <!-- Total Amount -->
                                        <div class="flex flex-row justify-between">
                                            <p class="text-left font-semibold text-sm w-56">Total Amount</p> 
                                            <!-- <span class="items-center font-semibold text-sm">:</span> -->
                                            <h3 class="text-right font-semibold text-sm w-20">{{ ordersGroup.total | currency: platform.currency }}</h3>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                    </ng-container>
                    <!-- No Products -->
                    <ng-template #noOrderGroup>
                        <div *ngIf="!isLoadingOnInit" class="relative w-full h-100 sm:h-auto max-h-160">
                            <error-background class="w-full static opacity-40"></error-background>
                            <div class="absolute flex flex-col inset-0 justify-center items-center">
                                <div class="w-full flex flex-col items-center justify-center z-10">
                                    <div class="mt-2 text-4xl md:text-5xl font-semibold tracking-tight leading-tight md:leading-none text-center">No Order Found!</div>
                                    <div class="mt-4 max-w-120 text-lg md:text-xl font-medium tracking-tight text-center text-secondary">No order found, shop and place your order with us.</div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="mb-12"></div> -->
                    </ng-template>
                    <!-- Pagination -->
                    <div class="flex w-full mt-4 items-center justify-center">
                        <pagination 
                            *ngIf="ordersGroupsPagination && ordersGroupsPagination.length > ordersGroupsPagination.size"
                            [itemLength]="ordersGroupsPagination.length" 
                            [initialPage]="ordersGroupsPagination.page + 1"
                            [pageSize]="ordersGroupsPagination.size"
                            (changePage)="onChangePage($event, 'orderGroups')"
                            (click)="scrollToTop()"
                            #ordersGroupsPaginator></pagination>
                    </div>
                    <!-- <div class="flex w-full mt-4 items-center justify-center">
                        <pagination 
                            *ngIf="qrOrdersPagination && qrOrdersPagination.length > qrOrdersPagination.size"
                            [itemLength]="qrOrdersPagination.length" 
                            [initialPage]="qrOrdersPagination.page + 1"
                            [pageSize]="qrOrdersPagination.size"
                            (changePage)="onChangePage($event, 'orderGroups')"
                            (click)="scrollToTop()"
                            #qrOrdersPaginator></pagination>
                    </div> -->
                </ng-template>
            </div>
        </div>
        
    </div>
</div>